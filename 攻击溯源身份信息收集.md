## 0x02 溯源取证中的攻击者身份信息收集

被攻陷的环境上往往留有不少攻击过程中留下的痕迹，这些痕迹有时能帮助取证人员溯源到攻击者的真实身份。



### 1 工具分析

使用逆向工程、字符串分析、行为分析等多种方式对从目标设备上提取到的恶意文件进行分析。提取其中有价值的特征。可能通过工具分析得到的信息有：

#### 1.1 名称

eg：

1.debug版本指示的调试文件路径中包含了特有的用户名。

2.authorized_keys中ssh公钥的主机名

3.注释信息



#### 1.2 联系方式

eg:

1.勒索软件的钱包地址

2.部分工具中含有的证书签名，发现其中含有邮箱地址。

3.“小学生”在黑页上留下的QQ、手机号



#### 1.3 外联地址

eg:

1.恶意样本运行时回连的地址

2.攻击流量的源地址

3.硬编码的域名或IP



### 2 日志历史记录分析

#### 2.1 外联地址

eg:

1.登录日志中的异常登录IP

2.历史记录中反弹shell操作中含有的外部地址

3.web日志中攻击请求的来源IP

4.持久化后门的外联地址



### 3 攻击地址分析

#### 3.1 IP分析

1.1 归属地查询

网上能查IP归属地的网站有很多。国家、运营商是最好确定的，基本上给出的搜索结果中都会直接给出来。

1.2 威胁情报查询

virustotal：https://www.virustotal.com/gui/ip-address/192.186.1.2/relations

threatbook：https://x.threatbook.cn/

#### 3.2 域名分析

whois查询一般能够获得域名拥有者的：**手机号**、**邮箱**、**姓名**。如果域名提供商对域名提供了隐藏保护，则不可行。

域名也可以过一遍威胁情报查询，看看是否已有公开记录。

#### 3.3 服务分析

端口扫描并服务发现，确定目标对外开放的服务。

针对服务进行反渗透，拿下主机后。翻日志、抓包、钓鱼等方式，确定目标的真实位置与身份。

